import { useCartStore } from "../../store/cartStore";

interface CartIconProps {
  className?: string;
}

export const CartIcon = ({ className = "" }: CartIconProps) => {
  const { itemCount, openDrawer } = useCartStore();

  const handleClick = () => {
    openDrawer();
  };

  return (
    <div
      onClick={handleClick}
      className={`relative inline-flex cursor-pointer ${className}`}
      data-testid="cart-icon"
    >
      <svg
        width="20"
        height="21"
        viewBox="0 0 20 21"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g clip-path="url(#clip0_4_5380)">
          <path
            d="M0.752197 2.92188C0.556885 2.92188 0.384359 2.84701 0.234619 2.69727C0.0848796 2.54753 0.0100098 2.375 0.0100098 2.17969C0.0100098 1.97135 0.0848796 1.79557 0.234619 1.65234C0.384359 1.50912 0.556885 1.4375 0.752197 1.4375H3.40845C3.57772 1.4375 3.73397 1.48307 3.8772 1.57422C4.02043 1.66537 4.11157 1.80208 4.15063 1.98438L7.15845 12.8828H15.4006L18.135 6.59375H8.99438C8.79907 6.59375 8.63306 6.52539 8.49634 6.38867C8.35962 6.25195 8.29126 6.07292 8.29126 5.85156C8.29126 5.65625 8.35962 5.48372 8.49634 5.33398C8.63306 5.18425 8.79907 5.10938 8.99438 5.10938H19.2678C19.385 5.10938 19.4989 5.14193 19.6096 5.20703C19.7203 5.27214 19.8147 5.35677 19.8928 5.46094C19.9449 5.55208 19.9775 5.66276 19.9905 5.79297C20.0035 5.92318 19.984 6.04688 19.9319 6.16406L16.5725 13.9375C16.5204 14.0677 16.4325 14.1719 16.3088 14.25C16.1851 14.3281 16.0517 14.3672 15.9084 14.3672H6.61157C6.4423 14.3672 6.29256 14.3151 6.16235 14.2109C6.03215 14.1068 5.94751 13.9766 5.90845 13.8203L2.86157 2.92188H0.752197ZM5.90845 19.5625C5.4397 19.5625 5.04256 19.3997 4.71704 19.0742C4.39152 18.7487 4.22876 18.3516 4.22876 17.8828C4.22876 17.4401 4.39152 17.0495 4.71704 16.7109C5.04256 16.3724 5.4397 16.2031 5.90845 16.2031C6.3772 16.2031 6.77433 16.3691 7.09985 16.7012C7.42537 17.0332 7.58813 17.4271 7.58813 17.8828C7.58813 18.3516 7.42537 18.7487 7.09985 19.0742C6.77433 19.3997 6.3772 19.5625 5.90845 19.5625ZM16.3772 19.5625C15.9475 19.5625 15.5732 19.416 15.2542 19.123C14.9351 18.8301 14.7626 18.4557 14.7366 18C14.6975 17.5573 14.8277 17.1569 15.1272 16.7988C15.4267 16.4408 15.8043 16.2422 16.26 16.2031C16.7288 16.1901 17.1389 16.3333 17.4905 16.6328C17.842 16.9323 18.0308 17.3099 18.0569 17.7656C18.0699 18 18.0439 18.2214 17.9788 18.4297C17.9137 18.638 17.8095 18.8333 17.6663 19.0156C17.51 19.1719 17.3342 19.2956 17.1389 19.3867C16.9436 19.4779 16.7288 19.5365 16.4944 19.5625H16.3772Z"
            fill="#333333"
          />
        </g>
        <defs>
          <clipPath id="clip0_4_5380">
            <rect
              width="20"
              height="20"
              fill="white"
              transform="matrix(1 0 0 -1 0.0100098 20.5)"
            />
          </clipPath>
        </defs>
      </svg>

      {itemCount > 0 && (
        <span
          className="absolute -top-2 -right-2  h-4 w-4 justify-center rounded-full text-xs font-semibold aspect-square text-white flex items-center"
          style={{ backgroundColor: "#72C7DA" }}
        >
          {itemCount > 99 ? "99+" : itemCount}
        </span>
      )}
    </div>
  );
};
